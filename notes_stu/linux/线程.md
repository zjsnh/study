# 线程

![image-20241006160110204](D:\code\study\notes_stu\c++_note\picture\image-20241006160110204.png)

![image-20241006171038835](D:\code\study\notes_stu\c++_note\picture\image-20241006171038835.png)

一个页框大小

![image-20241006171156225](D:\code\study\notes_stu\c++_note\picture\image-20241006171156225.png)

![image-20241006180403394](D:\code\study\notes_stu\c++_note\picture\image-20241006180403394.png)

![image-20241008151410798](D:\code\study\notes_stu\c++_note\picture\image-20241008151410798.png)

![image-20241008151420249](D:\code\study\notes_stu\c++_note\picture\image-20241008151420249.png)

![image-20241008154634112](D:\code\study\notes_stu\c++_note\picture\image-20241008154634112.png)

**线程库不属于系统库和C++/C代码，需要链接使用**

ps -al  查看轻量级进程（线程）

![image-20241008155027632](D:\code\study\notes_stu\c++_note\picture\image-20241008155027632.png)

![image-20241008155327600](D:\code\study\notes_stu\c++_note\picture\image-20241008155327600.png)

LWP跟PID相等，代表该线程是主线程，操作系统是按照LWP为单位执行的

Kill杀掉的以进程为单位，杀死任何一个线程都会杀掉进程

![image-20241008155912364](D:\code\study\notes_stu\c++_note\picture\image-20241008155912364.png)

![image-20241008160723331](D:\code\study\notes_stu\c++_note\picture\image-20241008160723331.png)

![image-20241008161136552](D:\code\study\notes_stu\c++_note\picture\image-20241008161136552.png)

args  传递参数

![image-20241008161152532](D:\code\study\notes_stu\c++_note\picture\image-20241008161152532.png)

管理线程退出（等待）

线程的等待函数

![image-20241008161625892](D:\code\study\notes_stu\c++_note\picture\image-20241008161625892.png)

**主线程等待默认是阻塞等待**

![image-20241008165124905](D:\code\study\notes_stu\c++_note\picture\image-20241008165124905.png)

获取线程返回值需要pthread_join 函数的retval传入指针获取

void*  64位  8字节

join不考虑异常的原因是因为，一个线程出问题，全部线程都崩了

exit终止进程，不能用来终止线程

pthread_exit终止线程

![image-20241008170528459](D:\code\study\notes_stu\c++_note\picture\image-20241008170528459.png)

取消一个线程

![image-20241008170705278](D:\code\study\notes_stu\c++_note\picture\image-20241008170705278.png)

![image-20241008170733020](D:\code\study\notes_stu\c++_note\picture\image-20241008170733020.png)

退出结果是-1

![image-20241008170847586](D:\code\study\notes_stu\c++_note\picture\image-20241008170847586.png)

![image-20241008172143391](D:\code\study\notes_stu\c++_note\picture\image-20241008172143391.png)

![image-20241008172156044](D:\code\study\notes_stu\c++_note\picture\image-20241008172156044.png)

传递自定义对象

堆空间是被线程共享的

C++11 也有线程库  \<thread>

简单接口  封装原生线程库

![image-20241008172922465](D:\code\study\notes_stu\c++_note\picture\image-20241008172922465.png)

![image-20241008174310384](D:\code\study\notes_stu\c++_note\picture\image-20241008174310384.png)

获取线程id  pthread_self()

创建一个轻量级进程

![image-20241008175027575](D:\code\study\notes_stu\c++_note\picture\image-20241008175027575.png)

![image-20241008175510498](D:\code\study\notes_stu\c++_note\picture\image-20241008175510498.png)

新开辟的线程的栈空间在共享区内

![image-20241008175813509](D:\code\study\notes_stu\c++_note\picture\image-20241008175813509.png)

![image-20241008180218344](D:\code\study\notes_stu\c++_note\picture\image-20241008180218344.png)